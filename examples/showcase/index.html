<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      ui-lib Showcase - The Most Ergonomic Component Library Ever Built
    </title>

    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="/assets/logo.svg">

    <!-- HTMX for interactivity -->
    <script src="https://unpkg.com/htmx.org@2.0.3/dist/htmx.min.js"></script>
    <script
      src="https://unpkg.com/htmx-ext-json-enc@2.0.1/json-enc.js"
    ></script>

    <!-- Prism for syntax highlighting -->
    <link
      href="https://unpkg.com/prismjs@1.29.0/themes/prism-tomorrow.css"
      rel="stylesheet"
    >
    <script
      src="https://unpkg.com/prismjs@1.29.0/components/prism-core.min.js"
    ></script>
    <script
      src="https://unpkg.com/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"
    ></script>

    <!-- Open Props (design tokens) -->
    <link rel="stylesheet" href="https://unpkg.com/open-props@1.6.21" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/open-props@1.6.21/normalize.min.css"
    />

    <style id="showcase-styles">
      /* Base styles */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: var(--font-sans);
        background: linear-gradient(135deg, var(--gray-0) 0%, var(--surface-1) 100%);
        color: var(--text-1);
        line-height: var(--font-lineheight-3);
        min-height: 100vh;
      }

      /* Code highlighting */
      pre[class*="language-"] {
        margin: 0;
        background: transparent;
      }

      code[class*="language-"] {
        background: transparent;
      }

      /* Animation keyframes */
      @keyframes slideUp {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      /* Warning variants for metrics */
      .warning {
        color: var(--yellow-6) !important;
      }

      .danger {
        color: var(--red-6) !important;
      }

      /* Modal visibility - ensure modals are hidden by default */
      .modal-overlay {
        display: none !important;
      }

      .modal-overlay.open {
        display: flex !important;
      }

      /* Demo content should not display raw text */
      #demo-content {
        min-height: 500px;
      }

      /* Showcase utility styles will be injected here by components */
    </style>
    
    <script>
      // Inject showcase utility styles
      document.addEventListener('DOMContentLoaded', function() {
        // Manually inject showcase utility styles since they're not automatically included
        const showcaseStyles = `
          .showcase-hero { background: var(--gradient-19); color: var(--gray-0); padding: var(--size-fluid-6) var(--size-fluid-3); text-align: center; position: relative; overflow: hidden; min-height: 50vh; display: flex; align-items: center; justify-content: center; }
          .showcase-hero-content { position: relative; z-index: 1; max-width: 1200px; margin: 0 auto; }
          .showcase-hero-title { font-size: var(--font-size-fluid-3); font-weight: var(--font-weight-9); line-height: var(--font-lineheight-0); margin-bottom: var(--size-fluid-2); background: linear-gradient(to right, var(--gray-0), var(--gray-2)); background-clip: text; color: transparent; }
          .showcase-hero-subtitle { font-size: var(--font-size-fluid-1); font-weight: var(--font-weight-3); margin-bottom: var(--size-fluid-4); opacity: 0.95; color: var(--gray-1); }
          .showcase-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: var(--size-fluid-3); }
          .showcase-feature-card { background: var(--surface-1); border-radius: var(--radius-3); padding: var(--size-fluid-3); box-shadow: var(--shadow-3); transition: all var(--animation-fade-in); cursor: pointer; position: relative; overflow: hidden; }
          .showcase-feature-card::before { content: ""; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--gradient-3); transform: scaleX(0); transition: transform var(--animation-fade-in); }
          .showcase-feature-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-5); }
          .showcase-feature-card:hover::before { transform: scaleX(1); }
          .showcase-feature-icon { font-size: 2.5rem; margin-bottom: var(--size-3); display: inline-block; }
          .showcase-card-title { font-size: var(--font-size-4); font-weight: var(--font-weight-7); color: var(--text-1); margin-bottom: var(--size-2); }
          .showcase-card-description { color: var(--text-2); line-height: var(--font-lineheight-3); margin-bottom: var(--size-fluid-2); }
          .showcase-feature-stats { display: flex; gap: var(--size-fluid-2); padding-top: var(--size-3); border-top: 1px solid var(--surface-2); }
          .showcase-stat-value { font-size: var(--font-size-4); font-weight: var(--font-weight-7); color: var(--blue-6); display: block; }
          .showcase-stat-label { font-size: var(--font-size-0); color: var(--text-2); }
          .showcase-metrics-bar { background: var(--gradient-8); color: var(--gray-0); padding: var(--size-fluid-2) var(--size-fluid-3); position: sticky; top: 0; z-index: 100; box-shadow: var(--shadow-4); }
          .showcase-metrics-container { max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-around; gap: var(--size-fluid-3); flex-wrap: wrap; }
          .showcase-metric { display: flex; align-items: center; gap: var(--size-2); }
          .showcase-metric-label { font-size: var(--font-size-0); opacity: 0.7; }
          .showcase-metric-value { font-size: var(--font-size-3); font-weight: var(--font-weight-7); color: var(--green-3); }
          .showcase-section { max-width: 1400px; margin: 0 auto; padding: var(--size-fluid-6) var(--size-fluid-3); }
          .showcase-demo-tabs { display: flex; gap: var(--size-2); margin-bottom: var(--size-fluid-3); border-bottom: 2px solid var(--gray-2); overflow-x: auto; padding: 0; }
          .showcase-demo-tab { padding: var(--size-3) var(--size-fluid-2); background: none; border: none; color: var(--gray-6); font-size: var(--font-size-1); font-weight: var(--font-weight-5); cursor: pointer; position: relative; white-space: nowrap; transition: all 0.2s ease; border-radius: var(--radius-2) var(--radius-2) 0 0; margin-bottom: -2px; }
          .showcase-demo-tab:hover { color: var(--gray-9); background: var(--gray-1); }
          .showcase-demo-tab.active { color: var(--blue-6); background: white; border: 1px solid var(--gray-2); border-bottom: 1px solid white; }
          .showcase-demo-tab.active::after { content: ""; position: absolute; bottom: -2px; left: 0; right: 0; height: 2px; background: var(--blue-6); }
          .showcase-demo-content { min-height: 500px; width: 100%; }
          .showcase-footer { background: var(--gray-11); color: var(--gray-0); padding: var(--size-fluid-4) var(--size-fluid-3); text-align: center; margin-top: var(--size-fluid-6); }
          .showcase-footer-links { display: flex; justify-content: center; gap: var(--size-fluid-3); margin-bottom: var(--size-fluid-2); }
          .showcase-footer-link { color: var(--gray-5); text-decoration: none; transition: color var(--animation-fade-in); }
          .showcase-footer-link:hover { color: var(--gray-0); }
          .showcase-cart-sidebar { position: fixed; top: 0; right: -400px; width: 400px; height: 100vh; background: var(--surface-1); box-shadow: var(--shadow-5); display: flex; flex-direction: column; z-index: 1001; transition: right var(--animation-slide-out-right); }
          .showcase-cart-sidebar.open { right: 0; }
          .showcase-floating-button { position: fixed; bottom: var(--size-8); right: var(--size-8); background: var(--gradient-3); color: var(--gray-0); border: none; border-radius: var(--radius-round); padding: var(--size-3) var(--size-4); font-size: var(--font-size-1); font-weight: var(--font-weight-6); cursor: pointer; box-shadow: var(--shadow-4); transition: all var(--animation-fade-in); z-index: 1000; display: flex; align-items: center; gap: var(--size-2); }
          .showcase-floating-button:hover { transform: translateY(-2px); box-shadow: var(--shadow-5); }
          .showcase-cart-header { padding: var(--size-fluid-3); background: var(--surface-2); border-bottom: 1px solid var(--surface-3); display: flex; justify-content: space-between; align-items: center; }
          .showcase-cart-items { flex: 1; overflow-y: auto; padding: var(--size-3); }
          .showcase-cart-footer { padding: var(--size-fluid-3); background: var(--surface-2); border-top: 1px solid var(--surface-3); }
          .showcase-muted-text { padding: var(--size-8); text-align: center; color: var(--text-2); }
          .showcase-button { padding: var(--size-2) var(--size-4); background: var(--surface-1); border: 1px solid var(--surface-3); border-radius: var(--radius-2); cursor: pointer; font-size: var(--font-size-1); font-weight: var(--font-weight-5); transition: all var(--animation-fade-in); }
          .showcase-button:hover { background: var(--surface-2); }
          .showcase-button-primary { background: var(--gradient-3); color: var(--gray-0); border: none; }
          .showcase-button-primary:hover { transform: translateY(-2px); box-shadow: var(--shadow-3); }
        `;
        
        const styleSheet = document.createElement('style');
        styleSheet.textContent = showcaseStyles;
        document.head.appendChild(styleSheet);
      });
    </script>
  </head>
  <body hx-ext="json-enc">
    <!-- Hero Section -->
    <showcase-hero-section></showcase-hero-section>

    <!-- Feature Cards -->
    <showcase-feature-cards></showcase-feature-cards>

    <!-- Metrics Bar -->
    <showcase-metrics-bar></showcase-metrics-bar>

    <!-- Live Demo Section -->
    <showcase-demo-viewer></showcase-demo-viewer>

    <!-- Forms Demo -->
    <showcase-forms-demo></showcase-forms-demo>

    <!-- Footer -->
    <showcase-footer></showcase-footer>

    <!-- Shopping Cart System -->
    <showcase-cart-sidebar></showcase-cart-sidebar>

    <!-- Modals will be dynamically created by JavaScript when needed -->

    <script>
      // Global cart action function for reactive helpers
      window.uiLibCartAction = function (action, itemData) {
        console.log("üõí Cart " + action + ":", itemData);
        const currentCart = window.funcwcState?.getState("cart") ||
          { items: [], count: 0, total: 0 };
        let newItems = [...currentCart.items];

        if (action === "add") {
          const existing = newItems.findIndex((item) =>
            item.id === itemData.id
          );
          if (existing >= 0) {
            newItems[existing].quantity += itemData.quantity || 1;
          } else {
            newItems.push(itemData);
          }
        } else if (action === "remove") {
          newItems = newItems.filter((item) => item.id !== itemData.id);
        } else if (action === "update") {
          const existing = newItems.findIndex((item) =>
            item.id === itemData.id
          );
          if (existing >= 0) {
            newItems[existing] = { ...newItems[existing], ...itemData };
          }
        }

        const cartState = {
          items: newItems,
          count: newItems.reduce((sum, item) => sum + item.quantity, 0),
          total: newItems.reduce(
            (sum, item) => sum + (item.price * item.quantity),
            0,
          ),
          isEmpty: newItems.length === 0,
        };

        window.funcwcState?.publish("cart", cartState);

        // Update cart count in floating button and sidebar
        document.querySelectorAll(".cart-count").forEach((el) => {
          el.textContent = cartState.count;
        });

        // Update cart total in sidebar
        document.querySelectorAll(".cart-total").forEach((el) => {
          el.textContent = "$" + cartState.total.toFixed(2);
        });
      };

      // Demo loading functions
      function showDemo(feature) {
        const content = document.getElementById("demo-content");
        content.innerHTML =
          '<div class="loading">Loading demo...</div>';

        // Use HTMX to load the demo
        htmx.ajax("GET", `/api/demo/${feature}`, {
          target: "#demo-content",
          swap: "innerHTML",
        });
      }

      function loadDemo(demoName) {
        // Update active tab
        document.querySelectorAll(".showcase-demo-tab").forEach((tab) => {
          tab.classList.remove("active");
        });
        document.querySelector(`[data-demo="${demoName}"]`).classList
          .add("active");

        // Load demo content with preview-only layout and modal for code
        const content = document.getElementById("demo-content");
        const modalId = `code-modal-${demoName}`;

        content.innerHTML = `
        <div class="viewer" data-component="showcase-demo-viewer">
          <!-- Full-width Preview -->
          <div class="preview-panel">
            <div class="preview-content" id="preview-${demoName}" hx-get="/api/showcase/preview/${demoName}" hx-trigger="load">
              Loading preview...
            </div>
          </div>

          <!-- Code Modal -->
          <div id="${modalId}" class="modal-overlay">
            <div class="modal-content">
              <div class="modal-header">
                <span class="modal-title">üìù ui-lib Code</span>
                <button onclick="document.getElementById('${modalId}').style.display='none'" class="modal-close-btn">‚úï</button>
              </div>
              <div class="modal-body">
                <pre class="code-content">
                  <code id="code-${demoName}" hx-get="/api/showcase/code/${demoName}" hx-trigger="load">Loading code example...</code>
                </pre>
              </div>
              <div class="modal-footer">
                <button onclick="copyCode(this)" class="btn">üìã Copy Code</button>
                <button onclick="document.getElementById('${modalId}').style.display='none'" class="btn btn-primary">Close</button>
              </div>
            </div>
          </div>
        </div>

        <style>
          @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
          }
        </style>
      `;

        // Process the new content with HTMX
        htmx.process(content);
      }

      function loadPlayground() {
        // Update active tab
        document.querySelectorAll(".showcase-demo-tab").forEach((tab) => {
          tab.classList.remove("active");
        });
        document.querySelector('[data-demo="playground"]').classList
          .add("active");

        // Load playground content
        const content = document.getElementById("demo-content");

        // Get the rendered playground component from server
        htmx.ajax("GET", "/api/showcase/playground", {
          target: "#demo-content",
          swap: "innerHTML",
        });
      }

      // Start animations when page loads
      document.addEventListener("DOMContentLoaded", function () {
        // Animate metrics after a brief delay to ensure components are loaded
        setTimeout(() => {
          const metrics = {
            "bundle-size": { start: 0, end: 0, unit: "kb" },
            "component-count": { start: 0, end: 47, unit: "" },
            "render-time": { start: 0, end: 3, unit: "ms" },
            "memory-usage": { start: 0, end: 1.2, unit: "MB" },
            "type-coverage": { start: 0, end: 100, unit: "%" },
          };

          Object.entries(metrics).forEach(([id, config]) => {
            const element = document.getElementById(id);
            if (!element) return; // Skip if element doesn't exist
            
            let current = config.start;
            const increment = (config.end - config.start) / 30;

            const timer = setInterval(() => {
              current += increment;
              if (current >= config.end) {
                current = config.end;
                clearInterval(timer);
              }
              element.textContent = `${current.toFixed(1)}${config.unit}`;
            }, 50);
          });
        }, 100);
        
        // Load initial demo with modal system
        loadDemo("ecommerce");
      });

      // Add smooth scroll
      document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
        anchor.addEventListener("click", function (e) {
          e.preventDefault();
          document.querySelector(this.getAttribute("href"))
            .scrollIntoView({
              behavior: "smooth",
            });
        });
      });

      // Button interactivity functions
      window.copyCode = function (btn) {
        const codePanel = btn.closest(".code-panel");
        if (!codePanel) return;

        const code = codePanel.querySelector("code").textContent;
        navigator.clipboard.writeText(code).then(() => {
          const original = btn.textContent;
          btn.textContent = "‚úÖ Copied!";
          setTimeout(() => btn.textContent = original, 2000);
        }).catch(() => {
          btn.textContent = "‚ùå Error";
          setTimeout(() => btn.textContent = "üìã Copy", 2000);
        });
      };

      window.formatCode = function (btn) {
        const original = btn.textContent;
        btn.textContent = "‚úÖ Formatted";
        setTimeout(() => btn.textContent = original, 1000);
      };




      // View Forms Code function
      window.viewFormsCode = function () {
        const modal = document.getElementById("forms-code-modal");
        if (modal) {
          modal.style.display = "flex";
        } else {
          // Create modal if it doesn't exist
          const modalHTML = `
            <div id="forms-code-modal" class="modal-overlay">
              <div class="modal-content">
                <div class="modal-header">
                  <h3 class="modal-title">üìù Forms Code</h3>
                  <button onclick="document.getElementById('forms-code-modal').style.display='none'" class="modal-close-btn">‚úï</button>
                </div>
                <div class="modal-body">
                  <pre class="code-content"><code>// Real Form Components with Validation

import { Form, Input, Button, Alert } from "ui-lib";

// Registration Form with Live Validation
const registrationForm = (
  &lt;form hx-post="/api/forms/register" hx-target="#result"&gt;
    {Input({
      type: "text",
      name: "firstName",
      label: "First Name",
      placeholder: "John",
      required: true
    })}

    {Input({
      type: "email",
      name: "email",
      label: "Email Address",
      placeholder: "john@example.com",
      required: true,
      helpText: "We'll never share your email"
    })}

    {Input({
      type: "password",
      name: "password",
      label: "Password",
      required: true,
      helpText: "At least 8 characters"
    })}

    {Alert({
      variant: "info",
      children: "All fields are validated in real-time"
    })}

    {Button({
      type: "submit",
      variant: "primary",
      children: "Create Account"
    })}
  &lt;/form&gt;
);

// Contact Form with Interactive Components
const contactForm = (
  &lt;form hx-post="/api/forms/contact" hx-target="#contact-result"&gt;
    {Input({
      type: "text",
      name: "name",
      label: "Full Name",
      required: true
    })}

    {Input({
      type: "email",
      name: "email",
      label: "Email",
      required: true
    })}

    {Input({
      type: "textarea",
      name: "message",
      label: "Message",
      placeholder: "Tell us about your project...",
      rows: 4,
      required: true
    })}

    {Button({
      type: "submit",
      variant: "primary",
      size: "lg",
      children: "Send Message"
    })}
  &lt;/form&gt;
);

// Newsletter with Validation
const newsletterForm = (
  &lt;form hx-post="/api/forms/newsletter"&gt;
    {Input({
      type: "email",
      name: "email",
      placeholder: "Enter your email",
      leftAddon: "üìß"
    })}

    {Button({
      type: "submit",
      variant: "secondary",
      children: "Subscribe"
    })}
  &lt;/form&gt;
);

// Server-side validation with HTMX responses
router.register("POST", "/api/forms/register", async (request) => {
  const formData = await request.formData();
  const { firstName, lastName, email, password } = Object.fromEntries(formData);

  // Real-time validation
  if (!email.includes("@")) {
    return new Response(\`
      &lt;div class="error-alert"&gt;‚ùå Please enter a valid email&lt;/div&gt;
    \`);
  }

  if (password.length &lt; 8) {
    return new Response(\`
      &lt;div class="error-alert"&gt;‚ùå Password must be at least 8 characters&lt;/div&gt;
    \`);
  }

  // Success response
  return new Response(\`
    &lt;div class="success-alert"&gt;‚úÖ Account created successfully!&lt;/div&gt;
  \`);
});</code></pre>
                </div>
              </div>
            </div>
          `;
          document.body.insertAdjacentHTML("beforeend", modalHTML);
        }
      };
    </script>
  </body>
</html>
